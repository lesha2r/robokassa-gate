–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è API –†–æ–±–æ–∫–∞—Å—Å–∞/Robokassa

# –ß—Ç–æ —É–º–µ–µ—Ç?
–í—Å—ë, –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –†–æ–±–æ–∫–∞—Å—Å–∞
* –§–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –¥–ª—è –æ–ø–ª–∞—Ç—ã
* –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —á–µ–∫–∞–º–∏
* –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤–µ–±—Ö—É–∫ –†–æ–±–æ–∫–∞—Å—Å—ã –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ –∑–∞–∫–∞–∑–∞
* –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç test-—Ä–µ–∂–∏–º

# –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç NPM
```
npm i robokassa-gate
```

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ
```
import RoboGate from 'robokassa-gate';

// –û–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
const config = {
    merchantLogin: 'myshopname',
    hashingAlgorithm: 'md5',
    password1: 'qwerty0123456789',
    password2: 'asdfgh0987654321',
    testMode: true,
    testPassword1: 'zxcvbn12345689',
    testPassword2: 'mnbvcx987654321',
    resultUrlRequestMethod: 'GET',
    // –ß–µ–∫ üëá
    // –ö–æ–¥—ã —Å–∏—Å—Ç–µ–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–∞–∂–µ–Ω–∏—è, –æ–±—ä–µ–∫—Ç–∞ –æ–ø–ª–∞—Ç—ã, –ù–î–° - 
    // —Å–º. –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –†–æ–±–æ–∫–∞—Å—Å—ã (https://docs.robokassa.ru/)
    receipt: {
        sno: "usn_income",
        paymentMethod: "full_payment",
        paymentObject: "service",
        tax: "none" 
    }
};

// –°–æ–∑–¥–∞—ë–º –∏–Ω—Å—Ç–∞–Ω—Å –∫–ª–∞—Å—Å–∞ RoboGate
const robokassa = new RoboGate(config);
```

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –¥–ª—è –æ–ø–ª–∞—Ç—ã
```
// –°—Å—ã–ª–∫–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞
let newOrderURL = robokassa.generatePaymentURL({
    invId: 1,
    invSumm: 700,
    invDescr: 'test payment',
    email: 'example@email.com',
    items: [
        { name: 'Product 1', quantity: 2, price: 200 },
        { name: 'Product 2', price: 300 }
    ],
    customData: { // –õ—é–±–∞—è –∫–∞—Å—Ç–æ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è; –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –≤ –≤–µ–±—Ö—É–∫–µ –æ–± –æ–ø–ª–∞—Ç–µ
        'any key': 'custom note' 
    }
});
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –æ–ø–ª–∞—Ç–µ
```
// Express.js
// –ê–¥—Ä–µ—Å, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –†–æ–±–æ–∫–∞—Å—Å—ã 
// (–ú–∞–≥–∞–∑–∏–Ω - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ - Result Url)
app.get('/payment-result/', (req, res) => {
    const isPaymentValidated = robokassa.validateResult(req);

    if (isPaymentValidated) {
        // ... –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ
    } else {
        // ... –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞, –µ—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞
    }
})
```

# TODOs
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –º–µ—Ç–æ–¥–∞ POST –¥–ª—è –≤–µ–±—Ö—É–∫–∞ –æ–± –æ–ø–ª–∞—Ç–µ

# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –†–æ–±–æ–∫–∞—Å—Å—ã
–°–º. https://docs.robokassa.ru/

# –ü–æ–º–æ—â—å
ü´° https://t.me/leshatour